{% extends 'base.html' %} 
{% block content %}
<div class="container mx-auto px-4 py-8">
    <!-- Back to Makanan Views Button -->
    <div class="mb-6">
        <a href="{% url 'dashboard:makanan_list' %}" 
           class="bg-white border border-black text-black text-center font-bold py-2 px-4 mt-4 rounded-md hover:bg-black hover:text-white transition-colors duration-300">
            Back to Makanan Views
        </a>
    </div>

    <!-- Filter Section -->
    <div class="bg-white p-6 rounded-lg shadow-md mb-6">
        <form method="GET" action="">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Kecamatan Filter -->
                <div class="space-y-2">
                    <label class="block text-sm font-medium text-gray-700">
                        Kecamatan
                    </label>
                    <select name="kecamatan" 
                            class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-gray-500">
                        <option value="all" {% if not selected_kecamatan %}selected{% endif %}>All Kecamatan</option>
                        {% for kecamatan in kecamatans %}
                            <option value="{{ kecamatan }}" 
                                    {% if selected_kecamatan == kecamatan %}selected{% endif %}>
                                {{ kecamatan }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
    
                <!-- Search Filter -->
                <div class="space-y-2">
                    <label class="block text-sm font-medium text-gray-700">
                        Search Restaurant
                    </label>
                    <input type="text" 
                           name="search" 
                           value="{{ search_query|default:'' }}"
                           placeholder="Search by name..." 
                           class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-gray-500">
                </div>
            </div>
    
            <!-- Submit Button -->
            <div class="flex justify-end mt-4">
                <button type="submit" 
                        class="block bg-white border border-black text-black text-center font-bold py-2 px-4 mt-4 rounded-md hover:bg-black hover:text-white transition-colors duration-300">
                    Apply Filters
                </button>
            </div>
        </form>
    </div>
        

    <!-- Restaurant Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for restaurant in restaurants %}
        <div class="bg-white rounded-lg shadow-md overflow-hidden">
            <img src="{{ restaurant.image }}" 
                 alt="{{ restaurant.resto_name }}" 
                 class="w-full h-48 object-cover">
            
            <div class="p-6">
                <h3 class="text-xl font-bold mb-2">{{ restaurant.resto_name }}</h3>
                <p class="text-gray-700">{{ restaurant.location }}</p>
                
                <div class="space-y-2 mt-4">
                    <div class="flex justify-between">
                        <span class="text-sm text-gray-700 font-bold">Kecamatan</span>
                        <span class="text-sm font-medium">{{ restaurant.kecamatan }}</span>
                    </div>
                    
                    <div class="flex justify-between">
                        <span class="text-sm text-gray-700 font-bold">Menu Items</span>
                        <span class="text-sm font-medium">{{ restaurant.menu_count }}</span>
                    </div>
                    
                    <div class="flex justify-between">
                        <span class="text-sm text-gray-700 font-bold">Price Range</span>
                        <span class="text-sm font-medium">
                            Rp {{ restaurant.min_price|floatformat:0 }} - 
                            Rp {{ restaurant.max_price|floatformat:0 }}
                        </span>
                    </div>
                </div>

                <div class="mt-4">
                    <a href="{% url 'dashboard:restaurant_menu' restaurant.resto_name %}"
                       class="block bg-white border border-black text-black text-center font-bold py-2 px-4 mt-4 rounded-md hover:bg-black hover:text-white transition-colors duration-300">
                        View Menu
                    </a>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-span-full flex flex-col items-center justify-center h-96">
            <img src= "https://i.pinimg.com/736x/e3/57/ea/e357ea1f87ec8694411bc18ecfbe3b9a.jpg"
                alt="No Results Found" class="mb-4" style="width: 150px; height: auto;">
            <p class="text-gray-600 text-center">No restaurants found matching your criteria. Please try again with different filters.</p>
        </div>
        {% endfor %}
    </div>

    <!-- Pagination -->
    {% if restaurants.paginator.num_pages > 1 %}
    <div class="flex justify-center mt-8">
        <div class="flex gap-2">
            {% if restaurants.has_previous %}
            <a href="?page={{ restaurants.previous_page_number }}{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}" 
                class="px-4 py-2 bg-white border border-black text-black text-center font-bold rounded-md hover:bg-black hover:text-white transition-colors duration-300">
                Previous
            </a>
            {% endif %}
    
            {% for num in restaurants.paginator.page_range %}
                {% if num == restaurants.number %}
                <span class="px-4 py-2 bg-black text-white rounded-lg rounded-md">{{ num }}</span>
                {% elif num > restaurants.number|add:'-3' and num < restaurants.number|add:'3' %}
                <a href="?page={{ num }}{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}"
                    class="px-4 py-2 bg-white border border-black text-black text-center font-bold rounded-md hover:bg-black hover:text-white transition-colors duration-300">
                    {{ num }}
                </a>
                {% endif %}
            {% endfor %}
    
            {% if restaurants.has_next %}
            <a href="?page={{ restaurants.next_page_number }}{% for key, value in request.GET.items %}{% if key != 'page' %}&{{ key }}={{ value }}{% endif %}{% endfor %}"
                class="px-4 py-2 bg-white border border-black text-black text-center font-bold rounded-md hover:bg-black hover:text-white transition-colors duration-300">
                Next
            </a>
            {% endif %}
        </div>
    </div>
    {% endif %}

</div>
{% endblock %}