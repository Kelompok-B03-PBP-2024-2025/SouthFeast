<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Culinary Insights</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        .container {
            display: flex;
            justify-content: space-between;
            padding: 20px;
            position: relative;
        }

        .articles, .qna {
            width: 45%;
            padding: 10px;
        }

        .divider {
            width: 1px;
            background-color: #ddd;
            height: 100%;
        }

        h2 {
            font-size: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .btn-add {
            padding: 10px 20px;
            border: 2px solid #fff;
            background-color: #000;
            color: white;
            cursor: pointer;
            text-transform: uppercase;
            font-size: 14px;
        }

        .btn-add:hover {
            background-color: #444;
        }

        .article-item, .qna-item {
            border: 1px solid #ddd;
            padding: 10px;
            margin-bottom: 15px;
        }

        /* Style for pop-up modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: #fefefe;
            padding: 20px;
            border-radius: 5px;
            width: 80%;
            max-width: 500px;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover, .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

        @media only screen and (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .articles, .qna {
                width: 100%;
            }

            .divider {
                display: none;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <!-- Articles Section -->
    <div class="articles">
        <h2>Articles 
            <!-- Button to add article only if user is authenticated -->
            {% if user.is_authenticated %}
                <button class="btn-add" id="add-article-btn">Add Article</button>
            {% endif %}
        </h2>

        <!-- Displaying articles -->
        {% if articles %}
            {% for article in articles %}
            <div class="article-item">
                <p><strong>{{ article.title }}</strong></p>
                <p>{{ article.description }}</p>
                <a href="{% if user.is_authenticated %}{% url 'forum:article_detail' article.id %}{% else %}{% url 'login' %}?next={% url 'forum:article_detail' article.id %}{% endif %}" class="btn-add">View More</a>
            </div>
            {% endfor %}
        {% else %}
            <p>No articles available yet.</p>
        {% endif %}
    </div>

    <!-- Divider -->
    <div class="divider"></div>

    <!-- QnA Section -->
    <div class="qna">
        <h2>QnA 
            <!-- Button to add question only if user is authenticated -->
            {% if user.is_authenticated %}
                <button class="btn-add" id="add-qna-btn">Add Question</button>
            {% endif %}
        </h2>

        <!-- Displaying questions -->
        {% if questions %}
            {% for question in questions %}
            <div class="qna-item">
                <p><strong>{{ question.title }}</strong></p>
                <p>{{ question.description }}</p>
                <a href="{% if user.is_authenticated %}{% url 'forum:question_detail' question.id %}{% else %}{% url 'login' %}?next={% url 'forum:question_detail' question.id %}{% endif %}" class="btn-add">View More</a>
            </div>
            {% endfor %}
        {% else %}
            <p>No questions available yet.</p>
        {% endif %}
    </div>
</div>

<!-- Modal for Add Article -->
<div id="addArticleModal" class="modal">
    <div class="modal-content">
        <span class="close" id="close-article-modal">&times;</span>
        <h3>Add Article</h3>
        <form method="POST" action="{% url 'forum:add_article' %}">
            {% csrf_token %}
            {{ article_form.as_p }}
            <button type="submit" class="btn-add">Submit</button>
        </form>
    </div>
</div>

<!-- Modal for Add Question -->
<div id="addQnaModal" class="modal">
    <div class="modal-content">
        <span class="close" id="close-qna-modal">&times;</span>
        <h3>Add Question</h3>
        <form method="POST" action="{% url 'forum:add_question' %}">
            {% csrf_token %}
            {{ question_form.as_p }}
            <button type="submit" class="btn-add">Submit</button>
        </form>
    </div>
</div>

<script>
    // Modal functionality
    var addArticleBtn = document.getElementById("add-article-btn");
    var addQnaBtn = document.getElementById("add-qna-btn");

    var addArticleModal = document.getElementById("addArticleModal");
    var addQnaModal = document.getElementById("addQnaModal");

    var closeArticleModal = document.getElementById("close-article-modal");
    var closeQnaModal = document.getElementById("close-qna-modal");

    addArticleBtn.onclick = function() {
        addArticleModal.style.display = "flex";
    }

    addQnaBtn.onclick = function() {
        addQnaModal.style.display = "flex";
    }

    closeArticleModal.onclick = function() {
        addArticleModal.style.display = "none";
    }

    closeQnaModal.onclick = function() {
        addQnaModal.style.display = "none";
    }

    window.onclick = function(event) {
        if (event.target == addArticleModal) {
            addArticleModal.style.display = "none";
        }
        if (event.target == addQnaModal) {
            addQnaModal.style.display = "none";
        }
    }
</script>

</body>
</html>
